import{r as e,c as a,l as s,m as l,a as t,w as u,n,q as i,h as c,o as r,b as o,d,t as v,e as m,x as p,A as f,s as _,B as g,i as h,C as k,D as y,E as x}from"./index-CiB9pT6W.js";import{o as b}from"./uni-app.es.Bg85OdED.js";import{D as j,f as w}from"./request.DWuOlu5v.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";const z=C({__name:"settings",setup(C){const z=e(!0),D=e(0),A=e([{name:"VincentZyu FastAPIä»£ç†ï¼ˆæ¨èï¼‰",url:"https://sh-aliyun2.vincentzyu233.cn/koishi-market-proxy/market",region:"å…¨çƒ",description:"è‡ªå»º FastAPI ä»£ç†æºï¼Œè§£å†³è·¨åŸŸé—®é¢˜"},{name:"NyanZone",url:"https://registry.nyan.zone/k/market/index.json",region:"å…¨çƒ",description:"å®˜æ–¹æ¨èæºï¼Œé€Ÿåº¦å¿«ä¸”ç¨³å®š"},{name:"ä¸Šå­¦èšåˆæº(å¤§é™†æ¨è)",url:"https://cdn.jsdmirror.com/gh/shangxueink/koishi-registry-aggregator@gh-pages/market.json",region:"å…¨çƒ",description:"èšåˆå¤šä¸ªæºçš„æ•°æ®ï¼Œæ’ä»¶æœ€å…¨"},{name:"t4wefanï¼ˆå¤§é™†ï¼‰",url:"https://registry.koishi.t4wefan.pub/index.json",region:"ä¸­å›½å¤§é™†",description:"å¤§é™†é•œåƒæºï¼Œå›½å†…è®¿é—®é€Ÿåº¦å¿«"},{name:"Lipratyï¼ˆå¤§é™†ï¼‰",url:"https://koi.nyan.zone/registry/index.json",region:"ä¸­å›½å¤§é™†",description:"å¤§é™†é•œåƒæºï¼Œå¤‡é€‰æ–¹æ¡ˆ"},{name:"itzdrliï¼ˆå…¨çƒï¼‰",url:"https://kp.itzdrli.cc",region:"å…¨çƒ",description:"å…¨çƒCDNæº"},{name:"Q78KGï¼ˆå…¨çƒï¼‰",url:"https://koishi-registry.yumetsuki.moe/index.json",region:"å…¨çƒ",description:"ç¤¾åŒºç»´æŠ¤æº"},{name:"Koishiå®˜æ–¹ï¼ˆå…¨çƒï¼‰",url:"https://registry.koishi.chat/index.json",region:"å…¨çƒ",description:"Koishi å®˜æ–¹æº"},{name:"ç¥ç§˜ç¤¾åŒºæº-miao",url:"http://miao-qinghuitou.vincentzyu233.cn:5140/storeluna/index.json",region:"ç¤¾åŒº",description:"ç¥ç§˜ç¤¾åŒºç»´æŠ¤çš„ç‰¹æ®Šæº"},{name:"è‡ªå®šä¹‰",url:"",region:"è‡ªå®šä¹‰",description:"ä½¿ç”¨ä¸‹æ–¹è‡ªå®šä¹‰åœ°å€"}]),I=e(0),V=e(""),q=e(!1),K=e(null),P=a((()=>I.value===A.value.length-1?V.value||j:A.value[I.value].url));s((()=>{const e=l("theme");e&&(z.value="dark"===e);const a=l("market_endpoint"),s=l("market_preset_index");null!=s&&(I.value=s),a&&(V.value=a)}));const $=()=>{z.value=!z.value,p("theme",z.value?"dark":"light")},B=e=>{if(I.value=e.detail.value,p("market_preset_index",I.value),I.value!==A.value.length-1){const e=A.value[I.value].url;p("market_endpoint",e)}K.value=null,f({title:"å·²åˆ‡æ¢æ•°æ®æº",icon:"success"})},F=()=>{V.value.trim()&&(I.value=A.value.length-1,p("market_preset_index",I.value),p("market_endpoint",V.value),K.value=null,f({title:"å·²ä¿å­˜è‡ªå®šä¹‰æº",icon:"success"}))},N=async()=>{if(P.value){q.value=!0,K.value=null;try{const e=Date.now(),a=await w({endpoint:P.value,isConsoleOutput:!1,isShowToast:!1}),s=Date.now()-e;K.value={success:!0,message:`è¿æ¥æˆåŠŸï¼è·å–åˆ° ${a.total} ä¸ªæ’ä»¶ï¼Œè€—æ—¶ ${s}ms`}}catch(e){K.value={success:!1,message:`è¿æ¥å¤±è´¥ï¼š${e.message||"ç½‘ç»œé”™è¯¯"}`}}finally{q.value=!1}}else f({title:"è¯·å…ˆè®¾ç½®æ•°æ®æº",icon:"none"})},T=()=>{_({title:"ç¡®è®¤æ¢å¤",content:"ç¡®å®šè¦æ¢å¤åˆ°é»˜è®¤æ•°æ®æºå—ï¼Ÿ",success:e=>{e.confirm&&(I.value=0,V.value="",p("market_preset_index",0),p("market_endpoint",A.value[0].url),K.value=null,f({title:"å·²æ¢å¤é»˜è®¤è®¾ç½®",icon:"success"}))}})},Z=()=>{g()};return b((()=>{})),(e,a)=>{const s=h,l=c,p=k,f=y,_=x;return r(),t(l,{class:n(["settings-page",{"dark-mode":z.value}]),style:i({paddingTop:D.value+"px"})},{default:u((()=>[o(l,{class:"settings-header"},{default:u((()=>[o(s,{class:"header-title"},{default:u((()=>[d("âš™ï¸ è®¾ç½®")])),_:1}),o(l,{class:"theme-toggle",onClick:$},{default:u((()=>[o(s,null,{default:u((()=>[d(v(z.value?"ğŸŒ™":"â˜€ï¸"),1)])),_:1})])),_:1})])),_:1}),o(l,{class:"settings-content"},{default:u((()=>[o(l,{class:"setting-section"},{default:u((()=>[o(l,{class:"section-title"},{default:u((()=>[o(s,{class:"title-icon"},{default:u((()=>[d("ğŸŒ")])),_:1}),o(s,{class:"title-text"},{default:u((()=>[d("æ’ä»¶å¸‚åœºæ•°æ®æº")])),_:1})])),_:1}),o(l,{class:"setting-item"},{default:u((()=>[o(s,{class:"item-label"},{default:u((()=>[d("é€‰æ‹©é¢„è®¾æº")])),_:1}),o(p,{mode:"selector",value:I.value,range:A.value,"range-key":"name",onChange:B,class:"preset-picker"},{default:u((()=>[o(l,{class:"picker-view-enhanced"},{default:u((()=>[o(l,{class:"picker-main"},{default:u((()=>[o(s,{class:"picker-name"},{default:u((()=>[d(v(A.value[I.value].name),1)])),_:1}),o(s,{class:"picker-description"},{default:u((()=>[d(v(A.value[I.value].description),1)])),_:1}),o(s,{class:"picker-url"},{default:u((()=>[d(v(A.value[I.value].url||"è¯·åœ¨ä¸‹æ–¹è¾“å…¥"),1)])),_:1})])),_:1}),o(s,{class:"picker-arrow"},{default:u((()=>[d("â–¼")])),_:1})])),_:1})])),_:1},8,["value","range"])])),_:1}),o(l,{class:"setting-item"},{default:u((()=>[o(s,{class:"item-label"},{default:u((()=>[d("è‡ªå®šä¹‰æºåœ°å€")])),_:1}),o(f,{class:"custom-input",modelValue:V.value,"onUpdate:modelValue":a[0]||(a[0]=e=>V.value=e),placeholder:"è¾“å…¥è‡ªå®šä¹‰ API ç«¯ç‚¹",onBlur:F,disabled:I.value!==A.value.length-1,"auto-height":""},null,8,["modelValue","disabled"]),I.value!==A.value.length-1?(r(),t(s,{key:0,class:"input-hint"},{default:u((()=>[d('è¯·å…ˆé€‰æ‹©"è‡ªå®šä¹‰"é€‰é¡¹')])),_:1})):m("",!0)])),_:1}),o(l,{class:"setting-item info-item"},{default:u((()=>[o(s,{class:"item-label"},{default:u((()=>[d("å½“å‰æºåœ°å€")])),_:1}),o(s,{class:"current-url"},{default:u((()=>[d(v(P.value),1)])),_:1})])),_:1}),o(l,{class:"source-info"},{default:u((()=>[o(l,{class:"info-row"},{default:u((()=>[o(s,{class:"info-label"},{default:u((()=>[d("åœ°åŒºï¼š")])),_:1}),o(s,{class:"info-value"},{default:u((()=>[d(v(A.value[I.value].region),1)])),_:1})])),_:1}),o(l,{class:"info-row"},{default:u((()=>[o(s,{class:"info-label"},{default:u((()=>[d("è¯´æ˜ï¼š")])),_:1}),o(s,{class:"info-value"},{default:u((()=>[d(v(A.value[I.value].description),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(l,{class:"action-section"},{default:u((()=>[o(_,{class:"test-btn",onClick:N,disabled:q.value},{default:u((()=>[o(s,null,{default:u((()=>[d(v(q.value?"æµ‹è¯•ä¸­...":"ğŸ” æµ‹è¯•è¿æ¥"),1)])),_:1})])),_:1},8,["disabled"]),o(_,{class:"reset-btn",onClick:T},{default:u((()=>[o(s,null,{default:u((()=>[d("ğŸ”„ æ¢å¤é»˜è®¤")])),_:1})])),_:1})])),_:1}),K.value?(r(),t(l,{key:0,class:n(["test-result",K.value.success?"success":"error"])},{default:u((()=>[o(s,{class:"result-icon"},{default:u((()=>[d(v(K.value.success?"âœ…":"âŒ"),1)])),_:1}),o(s,{class:"result-text"},{default:u((()=>[d(v(K.value.message),1)])),_:1})])),_:1},8,["class"])):m("",!0),o(l,{class:"back-section"},{default:u((()=>[o(_,{class:"back-btn",onClick:Z},{default:u((()=>[o(s,null,{default:u((()=>[d("â† è¿”å›æ’ä»¶å¸‚åœº")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class","style"])}}},[["__scopeId","data-v-2e2ccfda"]]);export{z as default};
