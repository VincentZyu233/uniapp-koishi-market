import{r as e,c as a,l,m as s,a as t,w as u,n,q as i,h as c,o as r,b as o,d,t as v,e as m,x as f,A as p,s as _,B as g,i as h,C as k,D as y,E as x}from"./index-B6HRVVbH.js";import{D as b,f as j}from"./request.bLIEgDnv.js";import{_ as w}from"./_plugin-vue_export-helper.BCo6x5W8.js";const C=w({__name:"settings",setup(w){const C=e(!0),z=e(0),D=e([{name:"VincentZyu FastAPIä»£ç†ï¼ˆæ¨èï¼‰",url:"https://sh-aliyun2.vincentzyu233.cn/koishi-market-proxy/market",region:"å…¨çƒ",description:"è‡ªå»º FastAPI ä»£ç†æºï¼Œè§£å†³è·¨åŸŸé—®é¢˜"},{name:"NyanZone",url:"https://registry.nyan.zone/k/market/index.json",region:"å…¨çƒ",description:"å®˜æ–¹æ¨èæºï¼Œé€Ÿåº¦å¿«ä¸”ç¨³å®š"},{name:"ä¸Šå­¦èšåˆæº(å¤§é™†æ¨è)",url:"https://cdn.jsdmirror.com/gh/shangxueink/koishi-registry-aggregator@gh-pages/market.json",region:"å…¨çƒ",description:"èšåˆå¤šä¸ªæºçš„æ•°æ®ï¼Œæ’ä»¶æœ€å…¨"},{name:"t4wefanï¼ˆå¤§é™†ï¼‰",url:"https://registry.koishi.t4wefan.pub/index.json",region:"ä¸­å›½å¤§é™†",description:"å¤§é™†é•œåƒæºï¼Œå›½å†…è®¿é—®é€Ÿåº¦å¿«"},{name:"Lipratyï¼ˆå¤§é™†ï¼‰",url:"https://koi.nyan.zone/registry/index.json",region:"ä¸­å›½å¤§é™†",description:"å¤§é™†é•œåƒæºï¼Œå¤‡é€‰æ–¹æ¡ˆ"},{name:"itzdrliï¼ˆå…¨çƒï¼‰",url:"https://kp.itzdrli.cc",region:"å…¨çƒ",description:"å…¨çƒCDNæº"},{name:"Q78KGï¼ˆå…¨çƒï¼‰",url:"https://koishi-registry.yumetsuki.moe/index.json",region:"å…¨çƒ",description:"ç¤¾åŒºç»´æŠ¤æº"},{name:"Koishiå®˜æ–¹ï¼ˆå…¨çƒï¼‰",url:"https://registry.koishi.chat/index.json",region:"å…¨çƒ",description:"Koishi å®˜æ–¹æº"},{name:"ç¥ç§˜ç¤¾åŒºæº-miao",url:"http://miao-qinghuitou.vincentzyu233.cn:5140/storeluna/index.json",region:"ç¤¾åŒº",description:"ç¥ç§˜ç¤¾åŒºç»´æŠ¤çš„ç‰¹æ®Šæº"},{name:"è‡ªå®šä¹‰",url:"",region:"è‡ªå®šä¹‰",description:"ä½¿ç”¨ä¸‹æ–¹è‡ªå®šä¹‰åœ°å€"}]),A=e(0),I=e(""),V=e(!1),q=e(null),K=a((()=>A.value===D.value.length-1?I.value||b:D.value[A.value].url));l((()=>{const e=s("theme");e&&(C.value="dark"===e);const a=s("market_endpoint"),l=s("market_preset_index");null!=l&&(A.value=l),a&&(I.value=a)}));const P=()=>{C.value=!C.value,f("theme",C.value?"dark":"light")},$=e=>{if(A.value=e.detail.value,f("market_preset_index",A.value),A.value!==D.value.length-1){const e=D.value[A.value].url;f("market_endpoint",e)}q.value=null,p({title:"å·²åˆ‡æ¢æ•°æ®æº",icon:"success"})},B=()=>{I.value.trim()&&(A.value=D.value.length-1,f("market_preset_index",A.value),f("market_endpoint",I.value),q.value=null,p({title:"å·²ä¿å­˜è‡ªå®šä¹‰æº",icon:"success"}))},F=async()=>{if(K.value){V.value=!0,q.value=null;try{const e=Date.now(),a=await j({endpoint:K.value,isConsoleOutput:!1,isShowToast:!1}),l=Date.now()-e;q.value={success:!0,message:`è¿æ¥æˆåŠŸï¼è·å–åˆ° ${a.total} ä¸ªæ’ä»¶ï¼Œè€—æ—¶ ${l}ms`}}catch(e){q.value={success:!1,message:`è¿æ¥å¤±è´¥ï¼š${e.message||"ç½‘ç»œé”™è¯¯"}`}}finally{V.value=!1}}else p({title:"è¯·å…ˆè®¾ç½®æ•°æ®æº",icon:"none"})},N=()=>{_({title:"ç¡®è®¤æ¢å¤",content:"ç¡®å®šè¦æ¢å¤åˆ°é»˜è®¤æ•°æ®æºå—ï¼Ÿ",success:e=>{e.confirm&&(A.value=0,I.value="",f("market_preset_index",0),f("market_endpoint",D.value[0].url),q.value=null,p({title:"å·²æ¢å¤é»˜è®¤è®¾ç½®",icon:"success"}))}})},T=()=>{g()};return(e,a)=>{const l=h,s=c,f=k,p=y,_=x;return r(),t(s,{class:n(["settings-page",{"dark-mode":C.value}]),style:i({paddingTop:z.value+"px"})},{default:u((()=>[o(s,{class:"settings-header"},{default:u((()=>[o(l,{class:"header-title"},{default:u((()=>[d("âš™ï¸ è®¾ç½®")])),_:1}),o(s,{class:"theme-toggle",onClick:P},{default:u((()=>[o(l,null,{default:u((()=>[d(v(C.value?"ğŸŒ™":"â˜€ï¸"),1)])),_:1})])),_:1})])),_:1}),o(s,{class:"settings-content"},{default:u((()=>[o(s,{class:"setting-section"},{default:u((()=>[o(s,{class:"section-title"},{default:u((()=>[o(l,{class:"title-icon"},{default:u((()=>[d("ğŸŒ")])),_:1}),o(l,{class:"title-text"},{default:u((()=>[d("æ’ä»¶å¸‚åœºæ•°æ®æº")])),_:1})])),_:1}),o(s,{class:"setting-item"},{default:u((()=>[o(l,{class:"item-label"},{default:u((()=>[d("é€‰æ‹©é¢„è®¾æº")])),_:1}),o(f,{mode:"selector",value:A.value,range:D.value,"range-key":"name",onChange:$,class:"preset-picker"},{default:u((()=>[o(s,{class:"picker-view-enhanced"},{default:u((()=>[o(s,{class:"picker-main"},{default:u((()=>[o(l,{class:"picker-name"},{default:u((()=>[d(v(D.value[A.value].name),1)])),_:1}),o(l,{class:"picker-description"},{default:u((()=>[d(v(D.value[A.value].description),1)])),_:1}),o(l,{class:"picker-url"},{default:u((()=>[d(v(D.value[A.value].url||"è¯·åœ¨ä¸‹æ–¹è¾“å…¥"),1)])),_:1})])),_:1}),o(l,{class:"picker-arrow"},{default:u((()=>[d("â–¼")])),_:1})])),_:1})])),_:1},8,["value","range"])])),_:1}),o(s,{class:"setting-item"},{default:u((()=>[o(l,{class:"item-label"},{default:u((()=>[d("è‡ªå®šä¹‰æºåœ°å€")])),_:1}),o(p,{class:"custom-input",modelValue:I.value,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),placeholder:"è¾“å…¥è‡ªå®šä¹‰ API ç«¯ç‚¹",onBlur:B,disabled:A.value!==D.value.length-1,"auto-height":""},null,8,["modelValue","disabled"]),A.value!==D.value.length-1?(r(),t(l,{key:0,class:"input-hint"},{default:u((()=>[d('è¯·å…ˆé€‰æ‹©"è‡ªå®šä¹‰"é€‰é¡¹')])),_:1})):m("",!0)])),_:1}),o(s,{class:"setting-item info-item"},{default:u((()=>[o(l,{class:"item-label"},{default:u((()=>[d("å½“å‰æºåœ°å€")])),_:1}),o(l,{class:"current-url"},{default:u((()=>[d(v(K.value),1)])),_:1})])),_:1}),o(s,{class:"source-info"},{default:u((()=>[o(s,{class:"info-row"},{default:u((()=>[o(l,{class:"info-label"},{default:u((()=>[d("åœ°åŒºï¼š")])),_:1}),o(l,{class:"info-value"},{default:u((()=>[d(v(D.value[A.value].region),1)])),_:1})])),_:1}),o(s,{class:"info-row"},{default:u((()=>[o(l,{class:"info-label"},{default:u((()=>[d("è¯´æ˜ï¼š")])),_:1}),o(l,{class:"info-value"},{default:u((()=>[d(v(D.value[A.value].description),1)])),_:1})])),_:1})])),_:1})])),_:1}),o(s,{class:"action-section"},{default:u((()=>[o(_,{class:"test-btn",onClick:F,disabled:V.value},{default:u((()=>[o(l,null,{default:u((()=>[d(v(V.value?"æµ‹è¯•ä¸­...":"ğŸ” æµ‹è¯•è¿æ¥"),1)])),_:1})])),_:1},8,["disabled"]),o(_,{class:"reset-btn",onClick:N},{default:u((()=>[o(l,null,{default:u((()=>[d("ğŸ”„ æ¢å¤é»˜è®¤")])),_:1})])),_:1})])),_:1}),q.value?(r(),t(s,{key:0,class:n(["test-result",q.value.success?"success":"error"])},{default:u((()=>[o(l,{class:"result-icon"},{default:u((()=>[d(v(q.value.success?"âœ…":"âŒ"),1)])),_:1}),o(l,{class:"result-text"},{default:u((()=>[d(v(q.value.message),1)])),_:1})])),_:1},8,["class"])):m("",!0),o(s,{class:"back-section"},{default:u((()=>[o(_,{class:"back-btn",onClick:T},{default:u((()=>[o(l,null,{default:u((()=>[d("â† è¿”å›æ’ä»¶å¸‚åœº")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class","style"])}}},[["__scopeId","data-v-b78950d1"]]);export{C as default};
