import{r as e,c as a,l,m as s,a as t,w as u,n,h as i,o as c,b as r,d as o,t as d,e as v,u as m,x as f,s as _,y as p,i as g,z as h,A as k,B as y}from"./index-dHB73C8e.js";import{D as x,f as b}from"./request.BwtBhe8O.js";import{_ as j}from"./_plugin-vue_export-helper.BCo6x5W8.js";const w=j({__name:"settings",setup(j){const w=e(!0),z=e([{name:"VincentZyu FastAPIä»£ç†ï¼ˆæ¨èï¼‰",url:"https://sh-aliyun2.vincentzyu233.cn/koishi-market-proxy/market",region:"å…¨çƒ",description:"è‡ªå»º FastAPI ä»£ç†æºï¼Œè§£å†³è·¨åŸŸé—®é¢˜"},{name:"NyanZone",url:"https://registry.nyan.zone/k/market/index.json",region:"å…¨çƒ",description:"å®˜æ–¹æ¨èæºï¼Œé€Ÿåº¦å¿«ä¸”ç¨³å®š"},{name:"ä¸Šå­¦èšåˆæº(å¤§é™†æ¨è)",url:"https://cdn.jsdmirror.com/gh/shangxueink/koishi-registry-aggregator@gh-pages/market.json",region:"å…¨çƒ",description:"èšåˆå¤šä¸ªæºçš„æ•°æ®ï¼Œæ’ä»¶æœ€å…¨"},{name:"t4wefanï¼ˆå¤§é™†ï¼‰",url:"https://registry.koishi.t4wefan.pub/index.json",region:"ä¸­å›½å¤§é™†",description:"å¤§é™†é•œåƒæºï¼Œå›½å†…è®¿é—®é€Ÿåº¦å¿«"},{name:"Lipratyï¼ˆå¤§é™†ï¼‰",url:"https://koi.nyan.zone/registry/index.json",region:"ä¸­å›½å¤§é™†",description:"å¤§é™†é•œåƒæºï¼Œå¤‡é€‰æ–¹æ¡ˆ"},{name:"itzdrliï¼ˆå…¨çƒï¼‰",url:"https://kp.itzdrli.cc",region:"å…¨çƒ",description:"å…¨çƒCDNæº"},{name:"Q78KGï¼ˆå…¨çƒï¼‰",url:"https://koishi-registry.yumetsuki.moe/index.json",region:"å…¨çƒ",description:"ç¤¾åŒºç»´æŠ¤æº"},{name:"Koishiå®˜æ–¹ï¼ˆå…¨çƒï¼‰",url:"https://registry.koishi.chat/index.json",region:"å…¨çƒ",description:"Koishi å®˜æ–¹æº"},{name:"ç¥ç§˜ç¤¾åŒºæº-miao",url:"http://miao-qinghuitou.vincentzyu233.cn:5140/storeluna/index.json",region:"ç¤¾åŒº",description:"ç¥ç§˜ç¤¾åŒºç»´æŠ¤çš„ç‰¹æ®Šæº"},{name:"è‡ªå®šä¹‰",url:"",region:"è‡ªå®šä¹‰",description:"ä½¿ç”¨ä¸‹æ–¹è‡ªå®šä¹‰åœ°å€"}]),C=e(0),A=e(""),D=e(!1),I=e(null),V=a((()=>C.value===z.value.length-1?A.value||x:z.value[C.value].url));l((()=>{const e=s("theme");e&&(w.value="dark"===e);const a=s("market_endpoint"),l=s("market_preset_index");null!=l&&(C.value=l),a&&(A.value=a)}));const K=()=>{w.value=!w.value,m("theme",w.value?"dark":"light")},P=e=>{if(C.value=e.detail.value,m("market_preset_index",C.value),C.value!==z.value.length-1){const e=z.value[C.value].url;m("market_endpoint",e)}I.value=null,f({title:"å·²åˆ‡æ¢æ•°æ®æº",icon:"success"})},$=()=>{A.value.trim()&&(C.value=z.value.length-1,m("market_preset_index",C.value),m("market_endpoint",A.value),I.value=null,f({title:"å·²ä¿å­˜è‡ªå®šä¹‰æº",icon:"success"}))},q=async()=>{if(V.value){D.value=!0,I.value=null;try{const e=Date.now(),a=await b({endpoint:V.value,isConsoleOutput:!1,isShowToast:!1}),l=Date.now()-e;I.value={success:!0,message:`è¿æ¥æˆåŠŸï¼è·å–åˆ° ${a.total} ä¸ªæ’ä»¶ï¼Œè€—æ—¶ ${l}ms`}}catch(e){I.value={success:!1,message:`è¿æ¥å¤±è´¥ï¼š${e.message||"ç½‘ç»œé”™è¯¯"}`}}finally{D.value=!1}}else f({title:"è¯·å…ˆè®¾ç½®æ•°æ®æº",icon:"none"})},B=()=>{_({title:"ç¡®è®¤æ¢å¤",content:"ç¡®å®šè¦æ¢å¤åˆ°é»˜è®¤æ•°æ®æºå—ï¼Ÿ",success:e=>{e.confirm&&(C.value=0,A.value="",m("market_preset_index",0),m("market_endpoint",z.value[0].url),I.value=null,f({title:"å·²æ¢å¤é»˜è®¤è®¾ç½®",icon:"success"}))}})},F=()=>{p()};return(e,a)=>{const l=g,s=i,m=h,f=k,_=y;return c(),t(s,{class:n(["settings-page",{"dark-mode":w.value}])},{default:u((()=>[r(s,{class:"settings-header"},{default:u((()=>[r(l,{class:"header-title"},{default:u((()=>[o("âš™ï¸ è®¾ç½®")])),_:1}),r(s,{class:"theme-toggle",onClick:K},{default:u((()=>[r(l,null,{default:u((()=>[o(d(w.value?"ğŸŒ™":"â˜€ï¸"),1)])),_:1})])),_:1})])),_:1}),r(s,{class:"settings-content"},{default:u((()=>[r(s,{class:"setting-section"},{default:u((()=>[r(s,{class:"section-title"},{default:u((()=>[r(l,{class:"title-icon"},{default:u((()=>[o("ğŸŒ")])),_:1}),r(l,{class:"title-text"},{default:u((()=>[o("æ’ä»¶å¸‚åœºæ•°æ®æº")])),_:1})])),_:1}),r(s,{class:"setting-item"},{default:u((()=>[r(l,{class:"item-label"},{default:u((()=>[o("é€‰æ‹©é¢„è®¾æº")])),_:1}),r(m,{mode:"selector",value:C.value,range:z.value,"range-key":"name",onChange:P,class:"preset-picker"},{default:u((()=>[r(s,{class:"picker-view-enhanced"},{default:u((()=>[r(s,{class:"picker-main"},{default:u((()=>[r(l,{class:"picker-name"},{default:u((()=>[o(d(z.value[C.value].name),1)])),_:1}),r(l,{class:"picker-description"},{default:u((()=>[o(d(z.value[C.value].description),1)])),_:1}),r(l,{class:"picker-url"},{default:u((()=>[o(d(z.value[C.value].url||"è¯·åœ¨ä¸‹æ–¹è¾“å…¥"),1)])),_:1})])),_:1}),r(l,{class:"picker-arrow"},{default:u((()=>[o("â–¼")])),_:1})])),_:1})])),_:1},8,["value","range"])])),_:1}),r(s,{class:"setting-item"},{default:u((()=>[r(l,{class:"item-label"},{default:u((()=>[o("è‡ªå®šä¹‰æºåœ°å€")])),_:1}),r(f,{class:"custom-input",modelValue:A.value,"onUpdate:modelValue":a[0]||(a[0]=e=>A.value=e),placeholder:"è¾“å…¥è‡ªå®šä¹‰ API ç«¯ç‚¹",onBlur:$,disabled:C.value!==z.value.length-1,"auto-height":""},null,8,["modelValue","disabled"]),C.value!==z.value.length-1?(c(),t(l,{key:0,class:"input-hint"},{default:u((()=>[o('è¯·å…ˆé€‰æ‹©"è‡ªå®šä¹‰"é€‰é¡¹')])),_:1})):v("",!0)])),_:1}),r(s,{class:"setting-item info-item"},{default:u((()=>[r(l,{class:"item-label"},{default:u((()=>[o("å½“å‰æºåœ°å€")])),_:1}),r(l,{class:"current-url"},{default:u((()=>[o(d(V.value),1)])),_:1})])),_:1}),r(s,{class:"source-info"},{default:u((()=>[r(s,{class:"info-row"},{default:u((()=>[r(l,{class:"info-label"},{default:u((()=>[o("åœ°åŒºï¼š")])),_:1}),r(l,{class:"info-value"},{default:u((()=>[o(d(z.value[C.value].region),1)])),_:1})])),_:1}),r(s,{class:"info-row"},{default:u((()=>[r(l,{class:"info-label"},{default:u((()=>[o("è¯´æ˜ï¼š")])),_:1}),r(l,{class:"info-value"},{default:u((()=>[o(d(z.value[C.value].description),1)])),_:1})])),_:1})])),_:1})])),_:1}),r(s,{class:"action-section"},{default:u((()=>[r(_,{class:"test-btn",onClick:q,disabled:D.value},{default:u((()=>[r(l,null,{default:u((()=>[o(d(D.value?"æµ‹è¯•ä¸­...":"ğŸ” æµ‹è¯•è¿æ¥"),1)])),_:1})])),_:1},8,["disabled"]),r(_,{class:"reset-btn",onClick:B},{default:u((()=>[r(l,null,{default:u((()=>[o("ğŸ”„ æ¢å¤é»˜è®¤")])),_:1})])),_:1})])),_:1}),I.value?(c(),t(s,{key:0,class:n(["test-result",I.value.success?"success":"error"])},{default:u((()=>[r(l,{class:"result-icon"},{default:u((()=>[o(d(I.value.success?"âœ…":"âŒ"),1)])),_:1}),r(l,{class:"result-text"},{default:u((()=>[o(d(I.value.message),1)])),_:1})])),_:1},8,["class"])):v("",!0),r(s,{class:"back-section"},{default:u((()=>[r(_,{class:"back-btn",onClick:F},{default:u((()=>[r(l,null,{default:u((()=>[o("â† è¿”å›æ’ä»¶å¸‚åœº")])),_:1})])),_:1})])),_:1})])),_:1})])),_:1},8,["class"])}}},[["__scopeId","data-v-3ec9407a"]]);export{w as default};
